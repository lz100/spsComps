<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Dynamically generate Shiny file selection component based on option — dynamicFile • spsComps</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Dynamically generate Shiny file selection component based on option — dynamicFile" />
<meta property="og:description" content="Depending on the &quot;mode&quot; in SPS options, this function renders
a similar UI components but behaves differently on server.
local mode will not copy file, directly
use a path pointer.
server mode upload file and store in temp. Expect
similar behavior as shiny::fileInput.

" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spsComps</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="https://systempipe.org/sps/">
    <span class="fa fa fa fa-home"></span>
     
    SPS Home
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/lz100/spsComps/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Dynamically generate Shiny file selection component based on option</h1>
    <small class="dont-index">Source: <a href='https://github.com/lz100/spsComps/blob/master/R/dynamic_file.R'><code>R/dynamic_file.R</code></a></small>
    <div class="hidden name"><code>dynamicFile.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Depending on the "mode" in SPS options, this function renders
a similar UI components but behaves differently on server.</p><ol>
<li><p><code>local</code> mode will not copy file, directly
use a path pointer.</p></li>
<li><p><code>server</code> mode upload file and store in temp. Expect
similar behavior as <a href='https://rdrr.io/pkg/shiny/man/fileInput.html'>shiny::fileInput</a>.</p></li>
</ol>

    </div>

    <pre class="usage"><span class='fu'>dynamicFile</span><span class='op'>(</span>
  <span class='va'>id</span>,
  title <span class='op'>=</span> <span class='st'>"Select your file:"</span>,
  label <span class='op'>=</span> <span class='st'>"Browse"</span>,
  icon <span class='op'>=</span> <span class='cn'>NULL</span>,
  style <span class='op'>=</span> <span class='st'>""</span>,
  multiple <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>

<span class='fu'>dynamicFileServer</span><span class='op'>(</span><span class='va'>input</span>, <span class='va'>session</span>, <span class='va'>id</span>, roots <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>root <span class='op'>=</span> <span class='st'>"default"</span><span class='op'>)</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>id</th>
      <td><p>element ID, Use <code>ns()</code> to wrap the id if you are using within a shiny
module, but DO NOT use <code>ns()</code> to wrap the id on server side</p></td>
    </tr>
    <tr>
      <th>title</th>
      <td><p>element title</p></td>
    </tr>
    <tr>
      <th>label</th>
      <td><p>upload button label</p></td>
    </tr>
    <tr>
      <th>icon</th>
      <td><p>button icon, only works for <code>local</code> mode</p></td>
    </tr>
    <tr>
      <th>style</th>
      <td><p>additional button style, only works for <code>local</code> mode</p></td>
    </tr>
    <tr>
      <th>multiple</th>
      <td><p>bool, are multiple files allowed?</p></td>
    </tr>
    <tr>
      <th>input</th>
      <td><p>shiny server input</p></td>
    </tr>
    <tr>
      <th>session</th>
      <td><p>shiny server session</p></td>
    </tr>
    <tr>
      <th>roots</th>
      <td><p>a named character vector, paths where users can reach
on the server, so only required for "server" mode, default is
current directory + all system volumes. You can lock users to a specific path,
so they are not allowed to browse parent folders.
like only current directory: <code><a href='https://rdrr.io/r/base/c.html'>c(current=getwd())</a></code>; a temp folder:
<code><a href='https://rdrr.io/r/base/c.html'>c(current=tempdir())</a></code>; unlimited: <code><a href='https://rdrr.io/r/base/c.html'>c(shinyFiles::getVolumes()())</a></code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a Shiny upload component on UI</p>
<p>For the server end it returns a
<strong>reactive</strong> object which is a dataframe, need to extract the value inside reactive
expression, observe, or inside <code>isolate</code>. See examples</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>To setup the option:</p>
<p>The <code>local</code> mode uses functions from shinyFiles so it will reach file system
on the <strong>server end</strong>. Although the latest shinyFiles limits users to only
specified server end location (folder), there is still some <strong>risk</strong>. That's why
it is named "local", you are encouraged to run the app on your local computer.
The advantage of "local" is: for some very large files, it does not upload and
store in the temp. Rather, it directly parses the path on the local file system
and return the path immediately. It means the file has to exist on the file
system that serves the Shiny app. If you deploy the app on places like shinyapps.io,
users can only choose files from server.</p>
<p>On the other hand, <code>server</code> mode uses original shiny default upload component.
Users can upload files from local to server. So users do not have access to
server end file system if you deploy it online. However, the limitations are:</p><ol>
<li><p>not ideal for large files, default limit is 30MB, and there is no break point
upload.</p></li>
<li><p>If you are running the app on your own computer, local end and server end is
the same, which is your computer. Using <code>server</code> mode will make a copy of your
existing file to temp location which is a waste of time and storage.</p></li>
</ol>

<p>To set up options:</p><ol>
<li><p>Under SPS framework, edit options in <code>global.R</code>.</p></li>
<li><p>Outside SPS framework with your own Shiny app, use <code><a href='https://rdrr.io/pkg/spsUtil/man/spsOption.html'>spsUtil::spsOption()</a></code> function,
like <code><a href='https://rdrr.io/pkg/spsUtil/man/spsOption.html'>spsUtil::spsOption("mode", "server")</a></code> or <code><a href='https://rdrr.io/pkg/spsUtil/man/spsOption.html'>spsUtil::spsOption("mode", "local")</a></code> to
set up mode.</p></li>
</ol>

<p>If you are not sure what mode you are on, use <code><a href='https://rdrr.io/pkg/spsUtil/man/spsOption.html'>spsUtil::spsOption('mode')</a></code> to check.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Simple example</span>
<span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>sps <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mode<span class='op'>=</span><span class='st'>'server'</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># Change the mode to 'local' to see difference</span>
    <span class='va'>ui</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/shiny/man/fluidPage.html'>fluidPage</a></span><span class='op'>(</span>
        <span class='fu'>dynamicFile</span><span class='op'>(</span><span class='st'>"server_file"</span>, <span class='st'>"server"</span><span class='op'>)</span>,
        <span class='fu'><a href='https://rdrr.io/pkg/shiny/man/textOutput.html'>verbatimTextOutput</a></span><span class='op'>(</span><span class='st'>"server_out"</span><span class='op'>)</span>
    <span class='op'>)</span>

    <span class='va'>server</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>input</span>,<span class='va'>output</span>,<span class='va'>session</span><span class='op'>)</span><span class='op'>{</span>
        <span class='va'>file_server</span> <span class='op'>&lt;-</span> <span class='fu'>dynamicFileServer</span><span class='op'>(</span><span class='va'>input</span>,<span class='va'>session</span>, id <span class='op'>=</span> <span class='st'>"server_file"</span><span class='op'>)</span>
        <span class='va'>output</span><span class='op'>$</span><span class='va'>server_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/shiny/man/renderPrint.html'>renderPrint</a></span><span class='op'>(</span><span class='op'>{</span>
            <span class='fu'>file_server</span><span class='op'>(</span><span class='op'>)</span>  <span class='co'># remember to use `()` for reactive value</span>
        <span class='op'>}</span><span class='op'>)</span>
    <span class='op'>}</span>
    <span class='fu'><a href='https://rdrr.io/pkg/shiny/man/shinyApp.html'>shinyApp</a></span><span class='op'>(</span>ui <span class='op'>=</span> <span class='va'>ui</span>, server <span class='op'>=</span> <span class='va'>server</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># To demostrate different modes in the same app, we can set options before the function.</span>
<span class='co'># This is NOT recommended, you should stick with only one mode for the entire app.</span>
<span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
    <span class='fu'>spsOption</span><span class='op'>(</span><span class='st'>"mode"</span>, <span class='st'>"local"</span><span class='op'>)</span>
    <span class='va'>local_ui</span> <span class='op'>&lt;-</span> <span class='fu'>dynamicFile</span><span class='op'>(</span><span class='st'>"local_file"</span>, <span class='st'>"local"</span><span class='op'>)</span>
    <span class='fu'>spsOption</span><span class='op'>(</span><span class='st'>"mode"</span>, <span class='st'>"server"</span><span class='op'>)</span>
    <span class='va'>server_ui</span> <span class='op'>&lt;-</span> <span class='fu'>dynamicFile</span><span class='op'>(</span><span class='st'>"server_file"</span>, <span class='st'>"server"</span><span class='op'>)</span>
    <span class='va'>ui</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/shiny/man/fluidPage.html'>fluidPage</a></span><span class='op'>(</span>
        <span class='fu'><a href='https://rdrr.io/pkg/shiny/man/column.html'>column</a></span><span class='op'>(</span>
            <span class='fl'>6</span>,
            <span class='va'>local_ui</span>,
            <span class='fu'><a href='https://rdrr.io/pkg/shiny/man/textOutput.html'>verbatimTextOutput</a></span><span class='op'>(</span><span class='st'>"local_out"</span><span class='op'>)</span>
        <span class='op'>)</span>,
        <span class='fu'><a href='https://rdrr.io/pkg/shiny/man/column.html'>column</a></span><span class='op'>(</span>
            <span class='fl'>6</span>,
            <span class='va'>server_ui</span>,
            <span class='fu'><a href='https://rdrr.io/pkg/shiny/man/textOutput.html'>verbatimTextOutput</a></span><span class='op'>(</span><span class='st'>"server_out"</span><span class='op'>)</span>
        <span class='op'>)</span>
    <span class='op'>)</span>

    <span class='va'>server</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>input</span>,<span class='va'>output</span>,<span class='va'>session</span><span class='op'>)</span><span class='op'>{</span>
        <span class='fu'>spsOption</span><span class='op'>(</span><span class='st'>"mode"</span>, <span class='st'>"local"</span><span class='op'>)</span>
        <span class='va'>file_local</span> <span class='op'>&lt;-</span> <span class='fu'>dynamicFileServer</span><span class='op'>(</span><span class='va'>input</span>,<span class='va'>session</span>, id <span class='op'>=</span> <span class='st'>"local_file"</span><span class='op'>)</span>
        <span class='va'>output</span><span class='op'>$</span><span class='va'>local_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/shiny/man/renderPrint.html'>renderPrint</a></span><span class='op'>(</span><span class='op'>{</span>
            <span class='fu'>file_local</span><span class='op'>(</span><span class='op'>)</span> <span class='co'># remember to use `()` for reactive value</span>
        <span class='op'>}</span><span class='op'>)</span>
        <span class='fu'>spsOption</span><span class='op'>(</span><span class='st'>"mode"</span>, <span class='st'>"server"</span><span class='op'>)</span>
        <span class='va'>file_server</span> <span class='op'>&lt;-</span> <span class='fu'>dynamicFileServer</span><span class='op'>(</span><span class='va'>input</span>,<span class='va'>session</span>, id <span class='op'>=</span> <span class='st'>"server_file"</span><span class='op'>)</span>
        <span class='va'>output</span><span class='op'>$</span><span class='va'>server_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/shiny/man/renderPrint.html'>renderPrint</a></span><span class='op'>(</span><span class='op'>{</span>
            <span class='fu'>file_server</span><span class='op'>(</span><span class='op'>)</span>
        <span class='op'>}</span><span class='op'>)</span>
    <span class='op'>}</span>
    <span class='fu'><a href='https://rdrr.io/pkg/shiny/man/shinyApp.html'>shinyApp</a></span><span class='op'>(</span>ui <span class='op'>=</span> <span class='va'>ui</span>, server <span class='op'>=</span> <span class='va'>server</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://lezhang.me/'>Le Zhang</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


